<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Manage your DataWaves account settings and profile information for mobile data purchases in Ghana.">
  <meta name="keywords" content="account, profile, settings, mobile data, Ghana, MTN, Telecel, AirtelTigo">
  <meta name="author" content="DataWaves">
  <meta name="robots" content="noindex, follow">
  <title>Account - DataWaves | Your Profile Settings</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    /* Account Page Specific Styles - Removed conflicting container styles */

    .page-header {
      text-align: center;
      padding: 40px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      position: relative;
      overflow: hidden;
    }

    .page-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    .page-header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .page-header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    /* Profile Section */
    .profile-section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin-bottom: 30px;
    }

    .profile-header {
      display: flex;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #f8f9fa;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: white;
      margin-right: 20px;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .profile-info h2 {
      margin: 0 0 5px 0;
      color: #333;
      font-size: 1.8rem;
    }

    .profile-info p {
      margin: 0;
      color: #6c757d;
      font-size: 1rem;
    }

    /* Profile Details Grid */
    .profile-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .detail-card {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      border-left: 4px solid #007bff;
      transition: all 0.3s ease;
    }

    .detail-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 123, 255, 0.15);
    }

    .detail-card.email {
      border-left-color: #28a745;
    }

    .detail-card.phone {
      border-left-color: #ffc107;
    }

    .detail-card.role {
      border-left-color: #dc3545;
    }

    .detail-card.date {
      border-left-color: #6f42c1;
    }

    .detail-label {
      font-size: 0.9rem;
      color: #6c757d;
      margin-bottom: 8px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .detail-value {
      font-size: 1.2rem;
      font-weight: bold;
      color: #333;
      word-break: break-word;
    }

    /* Account Stats */
    .account-stats {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin-bottom: 30px;
    }

    .stats-header {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      color: #333;
    }

    .stats-header h3 {
      margin: 0;
      font-size: 1.5rem;
    }

    .stats-header i {
      font-size: 1.8rem;
      margin-right: 15px;
      color: #007bff;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .stat-item {
      text-align: center;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .stat-item:hover {
      background: #e3f2fd;
      transform: translateY(-2px);
    }

    .stat-number {
      font-size: 2rem;
      font-weight: bold;
      color: #007bff;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.9rem;
      color: #6c757d;
      font-weight: 600;
    }

    /* Quick Actions */
    .quick-actions {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .actions-header {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      color: #333;
    }

    .actions-header h3 {
      margin: 0;
      font-size: 1.5rem;
    }

    .actions-header i {
      font-size: 1.8rem;
      margin-right: 15px;
      color: #28a745;
    }

    .actions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .action-card {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      padding: 25px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .action-card:hover {
      border-color: #007bff;
      background: #f8f9ff;
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 123, 255, 0.15);
      text-decoration: none;
      color: #333;
    }

    .action-card.primary:hover {
      border-color: #007bff;
      background: linear-gradient(135deg, #f8f9ff 0%, #e3f2fd 100%);
    }

    .action-card.success:hover {
      border-color: #28a745;
      background: linear-gradient(135deg, #f8fff8 0%, #d4edda 100%);
    }

    .action-card.warning:hover {
      border-color: #ffc107;
      background: linear-gradient(135deg, #fffdf8 0%, #fff3cd 100%);
    }

    .action-card.danger:hover {
      border-color: #dc3545;
      background: linear-gradient(135deg, #fff8f8 0%, #f8d7da 100%);
    }

    .action-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      color: white;
      margin-bottom: 10px;
    }

    .action-icon.primary {
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    }

    .action-icon.success {
      background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
    }

    .action-icon.warning {
      background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
    }

    .action-icon.danger {
      background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
    }

    .action-title {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .action-description {
      font-size: 0.9rem;
      color: #6c757d;
      line-height: 1.4;
    }

    /* Loading States */
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      color: #6c757d;
    }

    .spinner {
      border: 3px solid rgba(0, 0, 0, 0.1);
      border-left-color: #007bff;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin-right: 15px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .page-header h1 {
        font-size: 2rem;
      }
      
      .profile-header {
        flex-direction: column;
        text-align: center;
      }
      
      .profile-avatar {
        margin-right: 0;
        margin-bottom: 15px;
      }
      
      .profile-details {
        grid-template-columns: 1fr;
      }
      
      .actions-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Modern Navbar -->
  <nav class="navbar">
    <div class="navbar-container">
      <a href="index.html" class="navbar-brand">
        <div class="brand-icon">DW</div>
        <div class="brand-text">DataWaves</div>
      </a>
      
      <ul class="navbar-nav">
        <li class="nav-item">
          <a href="mtn.html" class="nav-link">
            <img src="images/mtn.png" alt="MTN">
            <span class="nav-tooltip">MTN Ghana</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="telecel.html" class="nav-link">
            <img src="images/telecel.png" alt="Telecel">
            <span class="nav-tooltip">Telecel Ghana</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="at.html" class="nav-link">
            <img src="images/airteltigo.png" alt="AirtelTigo">
            <span class="nav-tooltip">AirtelTigo Ghana</span>
          </a>
        </li>
      </ul>
      
      <div class="navbar-actions">
        <!-- User info will be displayed here after login -->
        <div id="user-info" class="user-menu" style="display: none;">
          <a href="account.html" class="user-button" id="user-button">
            <div class="user-avatar" id="user-avatar">U</div>
            <span id="user-name">Account</span>
          </a>
          <a href="#" onclick="logout()" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i>
            Logout
          </a>
        </div>
        
        <!-- Default auth links for logged out users -->
        <div id="auth-links-default" class="auth-buttons">
          <a href="login.html" class="auth-btn login">
            <i class="fas fa-sign-in-alt"></i>
            Login
          </a>
          <a href="register.html" class="auth-btn register">
            <i class="fas fa-user-plus"></i>
            Register
          </a>
          <a href="account.html" class="auth-btn account">
            <i class="fas fa-user"></i>
            Account
          </a>
        </div>
        
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Main Content Wrapper -->
  <main class="main-content">
    <!-- Account Content -->
  <div class="account-container">
    <!-- Page Header -->
    <div class="page-header">
      <h1><i class="fas fa-user-cog"></i> Account Settings</h1>
      <p>Manage your profile and account preferences</p>
    </div>

    <!-- Profile Section -->
    <div class="profile-section">
      <div class="profile-header">
        <div class="profile-avatar" id="userAvatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="profile-info">
          <h2 id="userDisplayName">Loading...</h2>
          <p>DataWaves Member</p>
        </div>
      </div>

      <div class="profile-details">
        <div class="detail-card">
          <div class="detail-label">
            <i class="fas fa-user"></i>
            Full Name
          </div>
          <div class="detail-value" id="userName">Loading...</div>
        </div>

        <div class="detail-card email">
          <div class="detail-label">
            <i class="fas fa-envelope"></i>
            Email Address
          </div>
          <div class="detail-value" id="userEmail">Loading...</div>
        </div>

        <div class="detail-card phone">
          <div class="detail-label">
            <i class="fas fa-phone"></i>
            Phone Number
          </div>
          <div class="detail-value" id="userPhone">Not provided</div>
        </div>

        <div class="detail-card role">
          <div class="detail-label">
            <i class="fas fa-shield-alt"></i>
            Account Type
          </div>
          <div class="detail-value" id="userRole">Loading...</div>
        </div>

        <div class="detail-card date">
          <div class="detail-label">
            <i class="fas fa-calendar-alt"></i>
            Member Since
          </div>
          <div class="detail-value" id="userCreatedAt">Loading...</div>
        </div>
      </div>
    </div>

    <!-- Account Stats -->
    <div class="account-stats">
      <div class="stats-header">
        <i class="fas fa-chart-bar"></i>
        <h3>Account Statistics</h3>
      </div>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-number" id="totalTransactions">0</div>
          <div class="stat-label">Total Purchases</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="totalSpent">GHC 0.00</div>
          <div class="stat-label">Total Spent</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="thisMonth">GHC 0.00</div>
          <div class="stat-label">This Month</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="lastPurchase">Never</div>
          <div class="stat-label">Last Purchase</div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <div class="actions-header">
        <i class="fas fa-bolt"></i>
        <h3>Quick Actions</h3>
      </div>
      <div class="actions-grid">
        <a href="dashboard.html" class="action-card primary">
          <div class="action-icon primary">
            <i class="fas fa-tachometer-alt"></i>
          </div>
          <div class="action-title">Dashboard</div>
          <div class="action-description">View your account overview and recent activity</div>
        </a>

        <a href="buy-plan.html" class="action-card success">
          <div class="action-icon success">
            <i class="fas fa-shopping-cart"></i>
          </div>
          <div class="action-title">Buy Data</div>
          <div class="action-description">Purchase mobile data bundles for any network</div>
        </a>

        <a href="receipt.html" class="action-card warning">
          <div class="action-icon warning">
            <i class="fas fa-receipt"></i>
          </div>
          <div class="action-title">View Receipt</div>
          <div class="action-description">Access your transaction receipts and history</div>
        </a>

        <a href="#" onclick="logout()" class="action-card danger">
          <div class="action-icon danger">
            <i class="fas fa-sign-out-alt"></i>
          </div>
          <div class="action-title">Logout</div>
          <div class="action-description">Sign out of your DataWaves account</div>
        </a>
      </div>
    </div>
  </div>
  </main>





  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <!-- Main Footer Content -->
      <div class="footer-content">
        <!-- Company Info -->
        <div class="footer-section">
          <div class="footer-brand">
            <div class="brand-icon">DW</div>
            <div class="brand-text">DataWaves</div>
          </div>
          <p class="footer-description">
            Ghana's leading mobile data provider offering fast, reliable, and affordable data bundles for MTN, Telecel, and AirtelTigo networks.
          </p>
          <div class="footer-stats">
            <div class="footer-stat">
              <i class="fas fa-clock"></i>
              <span>20 Min Delivery</span>
            </div>
            <div class="footer-stat">
              <i class="fas fa-shield-alt"></i>
              <span>100% Secure</span>
            </div>
            <div class="footer-stat">
              <i class="fas fa-headset"></i>
              <span>24/7 Support</span>
            </div>
          </div>
        </div>

        <!-- Networks -->
        <div class="footer-section">
          <h3>Supported Networks</h3>
          <div class="footer-networks">
            <div class="footer-network">
              <img src="images/mtn.png" alt="MTN Ghana">
              <div class="network-info">
                <h4>MTN Ghana</h4>
                <p>Prefixes: 024, 054, 055, 059</p>
                <p>Delivery: 15-20 minutes</p>
                <p class="network-note">All SIM types supported</p>
              </div>
            </div>
            <div class="footer-network">
              <img src="images/telecel.png" alt="Telecel Ghana">
              <div class="network-info">
                <h4>Telecel Ghana</h4>
                <p>Prefixes: 020, 050</p>
                <p>Delivery: 15-20 minutes</p>
                <p class="network-note">All SIM types supported</p>
              </div>
            </div>
            <div class="footer-network">
              <img src="images/airteltigo.png" alt="AirtelTigo Ghana">
              <div class="network-info">
                <h4>AirtelTigo Ghana</h4>
                <p>Prefixes: 026, 027, 056, 057</p>
                <p>Delivery: 15-20 minutes</p>
                <p class="network-note">All SIM types supported</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Services -->
        <div class="footer-section">
          <h3>Our Services</h3>
          <ul class="footer-links">
            <li><a href="buy-plan.html"><i class="fas fa-shopping-cart"></i> Buy Data Plans</a></li>
            <li><a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Account Dashboard</a></li>
            <li><a href="receipt.html"><i class="fas fa-receipt"></i> Transaction History</a></li>
            <li><a href="account.html"><i class="fas fa-user-cog"></i> Account Settings</a></li>
          </ul>
          
          <h4>Delivery Information</h4>
          <div class="delivery-info">
            <div class="delivery-item">
              <i class="fas fa-clock text-success"></i>
              <span>Average delivery: 15-20 minutes</span>
            </div>
            <div class="delivery-item">
              <i class="fas fa-bolt text-warning"></i>
              <span>Peak hours may take up to 30 minutes</span>
            </div>
            <div class="delivery-item">
              <i class="fas fa-mobile-alt text-info"></i>
              <span>SMS & Email notifications included</span>
            </div>
          </div>
        </div>

        <!-- Support -->
        <div class="footer-section">
          <h3>Support & Contact</h3>
          <div class="contact-info">
            <div class="contact-item">
              <i class="fas fa-phone"></i>
              <span>+233 20 849 4123</span>
            </div>
            <div class="contact-item">
              <i class="fas fa-envelope"></i>
              <span>support@datawaves.com</span>
            </div>
            <div class="contact-item">
              <i class="fas fa-clock"></i>
              <span>24/7 Customer Support</span>
            </div>
          </div>

          <h4>Important Notes</h4>
          <div class="important-notes">
            <div class="note-item">
              <i class="fas fa-info-circle text-info"></i>
              <span>No SIM type restrictions - All SIMs supported</span>
            </div>
            <div class="note-item">
              <i class="fas fa-check-circle text-success"></i>
              <span>Works with Prepaid & Postpaid SIMs</span>
            </div>
            <div class="note-item">
              <i class="fas fa-shield-alt text-primary"></i>
              <span>Secure payments via Paystack</span>
            </div>
            <div class="note-item">
              <i class="fas fa-redo text-warning"></i>
              <span>Failed deliveries automatically refunded</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Network Details Section -->
      <div class="network-details-section">
        <h3>Network Compatibility & Delivery Details</h3>
        <div class="network-details-grid">
          <!-- MTN Details -->
          <div class="network-detail-card mtn-card">
            <div class="network-header">
              <img src="images/mtn.png" alt="MTN Ghana">
              <h4>MTN Ghana</h4>
            </div>
            <div class="network-details">
              <div class="detail-group">
                <h5><i class="fas fa-mobile-alt"></i> Supported Numbers</h5>
                <p>024XXXXXXX, 054XXXXXXX, 055XXXXXXX, 059XXXXXXX</p>
              </div>
              <div class="detail-group">
                <h5><i class="fas fa-sim-card"></i> SIM Compatibility</h5>
                <p>‚úÖ All MTN SIM types supported</p>
                <p>‚úÖ Prepaid & Postpaid SIMs</p>
                <p>‚úÖ No restrictions on SIM age or type</p>
              </div>
              <div class="detail-group">
                <h5><i class="fas fa-clock"></i> Delivery Time</h5>
                <p>üöÄ Average: 15-20 minutes</p>
                <p>‚è∞ Peak hours: Up to 30 minutes</p>
                <p>üì± SMS notification upon delivery</p>
              </div>
            </div>
          </div>

          <!-- Telecel Details -->
          <div class="network-detail-card telecel-card">
            <div class="network-header">
              <img src="images/telecel.png" alt="Telecel Ghana">
              <h4>Telecel Ghana</h4>
            </div>
            <div class="network-details">
              <div class="detail-group">
                <h5><i class="fas fa-mobile-alt"></i> Supported Numbers</h5>
                <p>020XXXXXXX, 050XXXXXXX</p>
              </div>
              <div class="detail-group">
                <h5><i class="fas fa-sim-card"></i> SIM Compatibility</h5>
                <p>‚úÖ All Telecel SIM types supported</p>
                <p>‚úÖ Prepaid & Postpaid SIMs</p>
                <p>‚úÖ No restrictions on SIM age or type</p>
              </div>
              <div class="detail-group">
                <h5><i class="fas fa-clock"></i> Delivery Time</h5>
                <p>üöÄ Average: 15-20 minutes</p>
                <p>‚è∞ Peak hours: Up to 30 minutes</p>
                <p>üì± SMS notification upon delivery</p>
              </div>
            </div>
          </div>

          <!-- AirtelTigo Details -->
          <div class="network-detail-card airteltigo-card">
            <div class="network-header">
              <img src="images/airteltigo.png" alt="AirtelTigo Ghana">
              <h4>AirtelTigo Ghana</h4>
            </div>
            <div class="network-details">
              <div class="detail-group">
                <h5><i class="fas fa-mobile-alt"></i> Supported Numbers</h5>
                <p>026XXXXXXX, 027XXXXXXX, 056XXXXXXX, 057XXXXXXX</p>
              </div>
              <div class="detail-group">
                <h5><i class="fas fa-sim-card"></i> SIM Compatibility</h5>
                <p>‚úÖ All AirtelTigo SIM types supported</p>
                <p>‚úÖ Airtel, Tigo & merged SIMs</p>
                <p>‚úÖ No restrictions on SIM age or type</p>
              </div>
              <div class="detail-group">
                <h5><i class="fas fa-clock"></i> Delivery Time</h5>
                <p>üöÄ Average: 15-20 minutes</p>
                <p>‚è∞ Peak hours: Up to 30 minutes</p>
                <p>üì± SMS notification upon delivery</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer Bottom -->
      <div class="footer-bottom">
        <div class="footer-bottom-content">
          <div class="footer-left">
            <p>&copy; 2026 DataWaves. All rights reserved.</p>
            <p>Licensed mobile data provider in Ghana</p>
          </div>
          <div class="footer-right">
            <div class="footer-links-inline">
              <a href="#privacy">Privacy Policy</a>
              <a href="#terms">Terms of Service</a>
              <a href="#refund">Refund Policy</a>
              <a href="#contact">Contact Us</a>
            </div>
            <div class="payment-methods">
              <span>Secured by:</span>
              <img src="https://paystack.com/assets/img/logo/paystack-logo-blue.svg" alt="Paystack" class="payment-logo">
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>



  <script src="script.js"></script>
  <script>
    // Load user data and stats for account page
    document.addEventListener('DOMContentLoaded', function() {
      loadUserData();
      loadAccountStats();
    });

    function loadUserData() {
      fetch('/api/user')
        .then(res => res.json())
        .then(user => {
          if (user.error) {
            window.location.href = 'login.html';
            return;
          }
          
          // Update profile info
          const fullName = user.full_name || "User";
          document.getElementById("userName").textContent = fullName;
          document.getElementById("userDisplayName").textContent = fullName;
          document.getElementById("userEmail").textContent = user.email || "-";
          document.getElementById("userPhone").textContent = user.phone || "Not provided";
          document.getElementById("userRole").textContent = user.role === 'admin' ? 'Administrator' : 'Regular User';
          document.getElementById("userCreatedAt").textContent = user.created_at ? new Date(user.created_at).toLocaleDateString() : "-";
          
          // Update avatar with first letter of name
          const firstLetter = fullName.charAt(0).toUpperCase();
          document.getElementById("userAvatar").innerHTML = `<span style="font-size: 2rem; font-weight: bold;">${firstLetter}</span>`;
        })
        .catch(err => {
          console.error('Error fetching user data:', err);
          window.location.href = 'login.html';
        });
    }

    function loadAccountStats() {
      fetch('/api/transactions')
        .then(res => res.json())
        .then(transactions => {
          if (transactions.error) {
            return;
          }
          
          // Calculate stats
          const successfulTx = transactions.filter(tx => tx.status === 'success' || tx.status === 'paid');
          const totalTransactions = successfulTx.length;
          const totalSpent = successfulTx.reduce((sum, tx) => sum + parseFloat(tx.amount), 0);
          
          // Calculate monthly spending
          const currentMonth = new Date().getMonth();
          const currentYear = new Date().getFullYear();
          const monthlyTx = successfulTx.filter(tx => {
            const txDate = new Date(tx.created_at);
            return txDate.getMonth() === currentMonth && txDate.getFullYear() === currentYear;
          });
          const monthlySpent = monthlyTx.reduce((sum, tx) => sum + parseFloat(tx.amount), 0);
          
          // Last purchase date
          const lastPurchase = successfulTx.length > 0 ? 
            new Date(successfulTx[0].created_at).toLocaleDateString() : 'Never';
          
          // Update stats display
          document.getElementById('totalTransactions').textContent = totalTransactions;
          document.getElementById('totalSpent').textContent = `GHC ${totalSpent.toFixed(2)}`;
          document.getElementById('thisMonth').textContent = `GHC ${monthlySpent.toFixed(2)}`;
          document.getElementById('lastPurchase').textContent = lastPurchase;
        })
        .catch(err => {
          console.error('Error fetching transaction stats:', err);
        });
    }
  </script>
</body>
</html>