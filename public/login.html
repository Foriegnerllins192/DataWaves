<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Login to your DataWaves account to purchase mobile data bundles for MTN, Telecel, and AirtelTigo in Ghana. Secure and fast data delivery.">
  <meta name="keywords" content="login, mobile data, Ghana, account, MTN, Telecel, AirtelTigo, data bundles">
  <meta name="author" content="DataWaves">
  <meta name="robots" content="noindex, follow">
  <title>Login - DataWaves | Secure Mobile Data Account</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body class="auth-body">
  <!-- Modern Navbar -->
  <nav class="navbar">
    <div class="navbar-container">
      <a href="index.html" class="navbar-brand">
        <div class="brand-icon">DW</div>
        <div class="brand-text">DataWaves</div>
      </a>
      
      <ul class="navbar-nav">
        <li class="nav-item">
          <a href="mtn.html" class="nav-link">
            <img src="images/mtn.png" alt="MTN">
            <span class="nav-tooltip">MTN Ghana</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="telecel.html" class="nav-link">
            <img src="images/telecel.png" alt="Telecel">
            <span class="nav-tooltip">Telecel Ghana</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="at.html" class="nav-link">
            <img src="images/airteltigo.png" alt="AirtelTigo">
            <span class="nav-tooltip">AirtelTigo Ghana</span>
          </a>
        </li>
      </ul>
      
      <div class="navbar-actions">
        <div class="auth-buttons">
          <a href="login.html" class="auth-btn login">
            <i class="fas fa-sign-in-alt"></i>
            Login
          </a>
          <a href="register.html" class="auth-btn register">
            <i class="fas fa-user-plus"></i>
            Register
          </a>
        </div>
        
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Login Section -->
  <div class="auth-wrapper">
    <div class="auth-container">
      <div class="auth-card">
        <div class="auth-header">
          <div class="auth-icon">
            <i class="fas fa-sign-in-alt"></i>
          </div>
          <h1>Welcome Back</h1>
          <p>Sign in to your DataWaves account</p>
        </div>
        
        <form id="loginForm" class="auth-form">
          <div class="form-group">
            <div class="input-wrapper">
              <i class="fas fa-envelope input-icon"></i>
              <input type="email" id="email" name="email" placeholder="Enter your email" required />
              <label for="email">Email Address</label>
            </div>
          </div>
          
          <div class="form-group">
            <div class="input-wrapper">
              <i class="fas fa-lock input-icon"></i>
              <input type="password" id="password" name="password" placeholder="Enter your password" required />
              <label for="password">Password</label>
              <button type="button" class="password-toggle" onclick="togglePassword('password')">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
          
          <button type="submit" class="auth-btn">
            <span>Sign In</span>
            <i class="fas fa-arrow-right"></i>
          </button>
        </form>
        
        <div class="auth-footer">
          <p>Don't have an account? <a href="register.html" class="auth-link">Create one here</a></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Password toggle functionality
    function togglePassword(inputId) {
      const input = document.getElementById(inputId);
      const toggle = input.parentElement.querySelector('.password-toggle i');
      
      if (input.type === 'password') {
        input.type = 'text';
        toggle.classList.remove('fa-eye');
        toggle.classList.add('fa-eye-slash');
      } else {
        input.type = 'password';
        toggle.classList.remove('fa-eye-slash');
        toggle.classList.add('fa-eye');
      }
    }

    // Mobile menu toggle
    function toggleMobileMenu() {
      const navbarNav = document.querySelector('.navbar-nav');
      const authButtons = document.querySelector('.auth-buttons');
      navbarNav.classList.toggle('show');
      if (authButtons) {
        authButtons.classList.toggle('show');
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      const loginForm = document.getElementById('loginForm');

      // Add floating label effect
      const inputs = document.querySelectorAll('.input-wrapper input');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.parentElement.classList.add('focused');
        });
        
        input.addEventListener('blur', function() {
          if (this.value === '') {
            this.parentElement.classList.remove('focused');
          }
        });
        
        // Check if input has value on load
        if (input.value !== '') {
          input.parentElement.classList.add('focused');
        }
      });

      if (loginForm) {
        loginForm.addEventListener('submit', function (e) {
          e.preventDefault();
          const formData = new FormData(loginForm);
          const data = Object.fromEntries(formData);

          // Add loading state
          const submitBtn = loginForm.querySelector('.auth-btn');
          const originalText = submitBtn.innerHTML;
          submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
          submitBtn.disabled = true;

          fetch('/api/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
          })
          .then(res => res.json())
          .then(response => {
            if (response.success) {
              // Redirect based on user role
              if (response.user.role === 'admin') {
                window.location.href = "/admin/dashboard.html";
              } else {
                window.location.href = "/dashboard.html";
              }
            } else {
              alert(response.error || "Login failed!");
              submitBtn.innerHTML = originalText;
              submitBtn.disabled = false;
            }
          })
          .catch(err => {
            console.error('Error:', err);
            alert("Login failed! Please try again.");
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
          });
        });
      }
    });
  </script>
</body>
</html>